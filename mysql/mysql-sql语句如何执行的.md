![](img\20220914142941241.png)



### 首先客户端会经过 连接器

连接器管理连接和权限验证



### 分析器

语法分析，词法分析



### 查询缓存

mysql 8 查询缓存弃用----取消了Query Cache

原因：

sql 严格匹配：一个大小写字符不同都导致缓存无法命中

缓存受互斥锁的保护

（引入锁，有变化了，就锁起来，不让读缓存，然后变化完了，再重新生成缓存，给读端，并发高了，仅仅是个查询缓存都会成为MySQL的性能问题，不仅仅没有帮我们提升性能，反而让我们的应用变得越来越慢都是有可能的）

容易失效：update,delete,insert 会使缓存直接失效



缓存命中率很差，占内存 所以 mysql 8 取消

ProxySQL这样的第三方工具很成熟，可以充当中间缓存

我们可以使用 Redis 来实现缓存



### 优化器

生成计划，选择索引，连接方式，扫描方式



### 执行器

调用存储引擎的接口，返回结果



### 存储引擎

提供接口，存取数据





比如：select name from student where id=10 

1. 客户端发送查询请求：客户端向M小ySQL服务器发送该查询请求。
2. 服务器接收并解析SQL语句：MySQL服务器接收并解析该SQL查询语句，并进行语法和
   语义分析，以确保查询语句的正确性和合法性。
3. 查询缓存检查：ySQL服务器会先检查查询缓存，如果之前已经执行过该查询且缓存仍然
   有效，ySQL将直接返回缓存中的查询结果，跳过后续步骤。
4. 优化器生成执行计划：如果查询缓存中不存在或者无效，则ySQL服务器会使用查询优化
   器生成执行计划，该计划决定了如何执行该查询语句以获得最佳性能。在这个过程中，优化
   器可能会决定使用哪些索引、连接方式、扫描方式等。id走主键索引。
5. 存储引擎执行操作：执行计划被传递给存储引擎，存储引擎根据执行计划来执行查询，找到
   符合查询条件的记录。在这个查询语句中，条件是id=10 ,MySQL服务器会在student表中
   查找id等于10的记录。由于查询的是name字段，MySQL只需返回符合条件的记录中的
   name字段的值。
6. 返回结果给客户端：查询结会染返回绘客宝端，客户端可以处理结果。



![](img\20220914142941265..jpg)





### 操作SQL顺序

- FROM TABLE
- WHERE子句
- GROUP BY子句
- HAVING条款
- SELECT子句
- ORDER BY子句





### SQL语句优化






